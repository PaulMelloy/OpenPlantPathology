<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #20794d; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007ba5; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #007ba5; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #007ba5; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #20794d; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>

  <!--radix_placeholder_meta_tags-->
  <title>Network meta-analysis in R</title>

  <meta property="description" itemprop="description" content="Meta-analysis has gained popularity in Plant Pathology. Among the several methods, Network Meta-Analysis has been thoroughly presented to plant pathologists in a recent paper. In this post, I reproduce the analysis of the original paper which was conducted using SAS. Although the results are not identical, they are very similar."/>


  <!--  https://schema.org/Article -->
  <meta property="article:published" itemprop="datePublished" content="2021-02-28"/>
  <meta property="article:created" itemprop="dateCreated" content="2021-02-28"/>
  <meta name="article:author" content="Emerson Del Ponte"/>

  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="Network meta-analysis in R"/>
  <meta property="og:type" content="article"/>
  <meta property="og:description" content="Meta-analysis has gained popularity in Plant Pathology. Among the several methods, Network Meta-Analysis has been thoroughly presented to plant pathologists in a recent paper. In this post, I reproduce the analysis of the original paper which was conducted using SAS. Although the results are not identical, they are very similar."/>
  <meta property="og:locale" content="en_US"/>

  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="Network meta-analysis in R"/>
  <meta property="twitter:description" content="Meta-analysis has gained popularity in Plant Pathology. Among the several methods, Network Meta-Analysis has been thoroughly presented to plant pathologists in a recent paper. In this post, I reproduce the analysis of the original paper which was conducted using SAS. Although the results are not identical, they are very similar."/>

  <!--/radix_placeholder_meta_tags-->
  
  <meta name="citation_reference" content="citation_title=Statistical Models and Methods for Network Meta-Analysis;citation_publication_date=2016;citation_volume=106;citation_doi=10.1094/phyto-12-15-0342-rvw;citation_author=L. V. Madden;citation_author=H.-P. Piepho;citation_author=P. A. Paul"/>
  <!--radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","author","date","output","draft","bibliography","category","preview"]}},"value":[{"type":"character","attributes":{},"value":["Network meta-analysis in R"]},{"type":"character","attributes":{},"value":["Meta-analysis has gained popularity in Plant Pathology. Among the several methods, Network Meta-Analysis has been thoroughly presented to plant pathologists in a recent paper. In this post, I reproduce the analysis of the original paper which was conducted using SAS. Although the results are not identical, they are very similar. \n"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","url"]}},"value":[{"type":"character","attributes":{},"value":["Emerson Del Ponte"]},{"type":"character","attributes":{},"value":["https://twitter.com/edelponte"]}]}]},{"type":"character","attributes":{},"value":["02-28-2021"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained"]}},"value":[{"type":"logical","attributes":{},"value":[false]}]}]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["references.bib"]},{"type":"character","attributes":{},"value":["R4PlantPath"]},{"type":"character","attributes":{},"value":["meta.png"]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["~$wheat.xlsx","network-meta-analysis-in-r_files/anchor-4.2.2/anchor.min.js","network-meta-analysis-in-r_files/bowser-1.9.3/bowser.min.js","network-meta-analysis-in-r_files/distill-2.2.21/template.v2.js","network-meta-analysis-in-r_files/figure-html5/unnamed-chunk-17-1.png","network-meta-analysis-in-r_files/header-attrs-2.6.6/header-attrs.js","network-meta-analysis-in-r_files/jquery-1.11.3/jquery.min.js","network-meta-analysis-in-r_files/popper-2.6.0/popper.min.js","network-meta-analysis-in-r_files/tippy-6.2.7/tippy-bundle.umd.min.js","network-meta-analysis-in-r_files/tippy-6.2.7/tippy-light-border.css","network-meta-analysis-in-r_files/tippy-6.2.7/tippy.css","network-meta-analysis-in-r_files/tippy-6.2.7/tippy.umd.min.js","network-meta-analysis-in-r_files/webcomponents-2.0.0/webcomponents.js","references.bib","wheat.xlsx"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

  <style type="text/css">

  body {
    background-color: white;
  }

  .pandoc-table {
    width: 100%;
  }

  .pandoc-table>caption {
    margin-bottom: 10px;
  }

  .pandoc-table th:not([align]) {
    text-align: left;
  }

  .pagedtable-footer {
    font-size: 15px;
  }

  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }

  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }

  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }

  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }

  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }

  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
  }

  .html-widget {
    margin-bottom: 2.0em;
  }

  .l-screen-inset {
    padding-right: 16px;
  }

  .l-screen .caption {
    margin-left: 10px;
  }

  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .shaded-content {
    background: white;
  }

  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }

  .hidden {
    display: none !important;
  }

  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
  }

  d-appendix {
    padding-top: 30px;
  }

  d-article>p>img {
    width: 100%;
  }

  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }

  d-article h3 {
    margin-top: 1.5rem;
  }

  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }

  /* Tweak code blocks */

  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }

  d-article div.sourceCode {
    background-color: white;
  }

  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }

  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  d-article pre a {
    border-bottom: none;
  }

  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }

  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }

  @media(min-width: 768px) {

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }

  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }

  d-article pre {
    font-size: 14px;
  }

  }

  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  /* CSS for d-contents */

  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }

  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }

  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }

  .d-contents li {
    list-style-type: none
  }

  .d-contents nav > ul {
    padding-left: 0;
  }

  .d-contents ul {
    padding-left: 1em
  }

  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }

  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }

  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }

  .d-contents nav > ul > li > a {
    font-weight: 600;
  }

  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }

  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }


  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }

  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }


  /* Figure */

  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }

  .figure img {
    width: 100%;
  }

  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }

  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }

  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }

  /* Citations */

  d-article .citation {
    color: inherit;
    cursor: inherit;
  }

  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }

  /* Citation hover box */

  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }

  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }


  /* Tweak 1000px media break to show more text */

  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }

    .grid {
      grid-column-gap: 16px;
    }

    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }

  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }

    .grid {
      grid-column-gap: 32px;
    }
  }


  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */

  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Include appendix styles here so they can be overridden */

  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }

  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }

  d-appendix h3 + * {
    margin-top: 1em;
  }

  d-appendix ol {
    padding: 0 0 0 15px;
  }

  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }

  d-appendix li {
    margin-bottom: 1em;
  }

  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }

  d-appendix > * {
    grid-column: text;
  }

  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }

  /* Include footnote styles here so they can be overridden */

  d-footnote-list {
    contain: layout style;
  }

  d-footnote-list > * {
    grid-column: text;
  }

  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }



  /* Anchor.js */

  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }

  /* Social footer */

  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }

  .disqus-comments {
    margin-right: 30px;
  }

  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }

  #disqus_thread {
    margin-top: 30px;
  }

  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }

  .article-sharing a:hover {
    border-bottom: none;
  }

  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }

  .subscribe p {
    margin-bottom: 0.5em;
  }


  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }


  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }

  .custom p {
    margin-bottom: 0.5em;
  }

  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }

  /* Styles for posts lists (not auto-injected) */


  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }

  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }

  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }

  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }

  .post-preview-last {
    border-bottom: none !important;
  }

  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }

  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }

  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }

  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }

  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }

  .posts-list .metadata > * {
    display: inline-block;
  }

  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }

  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }

  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }

  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  .posts-list img {
    opacity: 1;
  }

  .posts-list img[data-src] {
    opacity: 0;
  }

  .posts-more {
    clear: both;
  }


  .posts-sidebar {
    font-size: 16px;
  }

  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }

  .sidebar-section {
    margin-bottom: 30px;
  }

  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }

  .categories li>a {
    border-bottom: none;
  }

  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }

  .categories .active {
    font-weight: 600;
  }

  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }


  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }


  /* Improve display for browsers without grid (IE/Edge <= 15) */

  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }

  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }

  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }

  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }

  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }

  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }


  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }

  .downlevel .footnotes ol {
    padding-left: 13px;
  }

  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }

  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }

  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  .downlevel .posts-list .post-preview {
    color: inherit;
  }



  </style>

  <script type="application/javascript">

  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }

  // show body when load is complete
  function on_load_complete() {

    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }


    // set body to visible
    document.body.style.visibility = 'visible';

    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }

    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }

  function init_distill() {

    init_common();

    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);

    // create d-title
    $('.d-title').changeElementType('d-title');

    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);

    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();

    // move posts container into article
    $('.posts-container').appendTo($('d-article'));

    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');

    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;

    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();

    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));

    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });

    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');

    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {

      // capture layout
      var layout = $(this).attr('data-layout');

      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });


      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });

    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();

    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme
    $('code.sourceCode a:empty').remove();

    // load distill framework
    load_distill_framework();

    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {

      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;

      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');

      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');

      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });

      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }

      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");

      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }

       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }

      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();

      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();

      // hoverable references
      $('span.citation[data-cites]').each(function() {
        var refHtml = $('#ref-' + $(this).attr('data-cites')).html();
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });

      // clear polling timer
      clearInterval(tid);

      // show body now that everything is ready
      on_load_complete();
    }

    var tid = setInterval(distill_post_process, 50);
    distill_post_process();

  }

  function init_downlevel() {

    init_common();

     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));

    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;

    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();

    // remove toc
    $('.d-contents').remove();

    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });


    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);

    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();

    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });

    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));

    $('body').addClass('downlevel');

    on_load_complete();
  }


  function init_common() {

    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};

        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });

        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);

    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});

    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });

      }
    });

    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });

    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace("index.html", "./"));
      });
    }

    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');

    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");

    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();

    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });

  </script>

  <!--/radix_placeholder_distill-->
  <script src="network-meta-analysis-in-r_files/header-attrs-2.6.6/header-attrs.js"></script>
  <script src="network-meta-analysis-in-r_files/jquery-1.11.3/jquery.min.js"></script>
  <script src="network-meta-analysis-in-r_files/popper-2.6.0/popper.min.js"></script>
  <link href="network-meta-analysis-in-r_files/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="network-meta-analysis-in-r_files/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="network-meta-analysis-in-r_files/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="network-meta-analysis-in-r_files/anchor-4.2.2/anchor.min.js"></script>
  <script src="network-meta-analysis-in-r_files/bowser-1.9.3/bowser.min.js"></script>
  <script src="network-meta-analysis-in-r_files/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="network-meta-analysis-in-r_files/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Network meta-analysis in R","description":"Meta-analysis has gained popularity in Plant Pathology. Among the several methods, Network Meta-Analysis has been thoroughly presented to plant pathologists in a recent paper. In this post, I reproduce the analysis of the original paper which was conducted using SAS. Although the results are not identical, they are very similar.","authors":[{"author":"Emerson Del Ponte","authorURL":"https://twitter.com/edelponte","affiliation":"&nbsp;","affiliationURL":"#","orcidID":""}],"publishedDate":"2021-02-28T00:00:00.000+00:00","citationText":"Ponte, 2021"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Network meta-analysis in R</h1>
<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->
<p><p>Meta-analysis has gained popularity in Plant Pathology. Among the several methods, Network Meta-Analysis has been thoroughly presented to plant pathologists in a recent paper. In this post, I reproduce the analysis of the original paper which was conducted using SAS. Although the results are not identical, they are very similar.</p></p>
</div>

<div class="d-byline">
  Emerson Del Ponte <a href="https://twitter.com/edelponte" class="uri">https://twitter.com/edelponte</a> 
  
<br/>02-28-2021
</div>

<div class="d-article">
<h3 id="why-and-who-is-this-post-for">Why and who is this post for?</h3>
<p>Meta-analysis has gained popularity in Plant Pathology. Among the several methods, Network Meta-Analysis (NMA) models, also known as Mixed Treatment Comparison (MTC), has been thoroughly presented to plant pathologists in a recent review paper in <em>Phytopathology</em> <span class="citation" data-cites="madden2016"><a href="#ref-madden2016" role="doc-biblioref">Madden, Piepho, and Paul</a> (<a href="#ref-madden2016" role="doc-biblioref">2016</a>)</span>.</p>
<p>A recent survey (Del Ponte, unpublished) showed that the more than 50 scientific articles have been published using plant disease data. Although this is very little compared with other fields, there is a trend towards increasing its use, especially with some structures of the data for which a multiple treatment comparison is of interest (see links to papers at the end of this post). Hence, this post is for those who have interest in learning how to fit network models using open source tools, as alternative to SAS and other commercial software.</p>
<p>As a use case, I reproduce the analysis in the review paper wher the authors made available all the data (wheat yield response to fungicides) and the codes using SAS <span class="citation" data-cites="madden2016"><a href="#ref-madden2016" role="doc-biblioref">Madden, Piepho, and Paul</a> (<a href="#ref-madden2016" role="doc-biblioref">2016</a>)</span>, using one meta-analysis-specific packages in R, the <a href="https://www.metafor-project.org/doku.php/help">metafor</a> package, which allowed me to fit the same model, the arm-based or uncondional, fitted in the original paper. I will reproduce some, not all, of the arm-based models presented in the original paper using a meta-analysis-specific package called <code>metafor</code>. I will explain the details on how to prepare the data, visualize the responses, fit the models and compare results with the original paper.</p>
<h3 id="data-preparation">Data preparation</h3>
<p>The data were obtained from the supplemental <a href="https://apsjournals.apsnet.org/doi/suppl/10.1094/PHYTO-12-15-0342-RVW/suppl_file/PHYTO-12-15-0342-RVW.s1.sas">FileS1</a>, a SAS file that contains a documented code and the data. Here, the data were organized in an MS Excel file following the same original structure and content, excepting that missing data was represented by an empty cell. Let’s load some packages for data importing and wrangling.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://tidyverse.tidyverse.org'>tidyverse</a></span><span class='op'>)</span> <span class='co'># load several useful pkgs</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://readxl.tidyverse.org'>readxl</a></span><span class='op'>)</span> <span class='co'># import data excel data</span>
</code></pre>
</div>
</div>
<p>Now we are ready to import the data and convert both yield and variance to metric unit as performed in the paper. Note: we do not need to create the weight variable as in the SAS code because this is handled in the meta-analysis specific R packages.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>wheat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://readxl.tidyverse.org/reference/read_excel.html'>read_excel</a></span><span class='op'>(</span><span class='st'>"wheat.xlsx"</span><span class='op'>)</span>
<span class='va'>wheat</span> <span class='op'>&lt;-</span> <span class='va'>wheat</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span>varyld <span class='op'>=</span> <span class='op'>(</span><span class='fl'>1</span><span class='op'>/</span><span class='va'>wtyield</span><span class='op'>)</span><span class='op'>*</span><span class='op'>(</span><span class='fl'>0.0628</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span>, 
         yield <span class='op'>=</span> <span class='va'>yield</span> <span class='op'>*</span> <span class='fl'>0.0628</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/r/stats/na.fail.html'>na.omit</a></span><span class='op'>(</span><span class='op'>)</span> <span class='co'># here we omit the rows with missing data</span>
</code></pre>
</div>
</div>
<p>Let’s replace the names of the levels of the treatment factor from number to acronyn.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>wheat</span> <span class='op'>&lt;-</span> <span class='va'>wheat</span> <span class='op'>%&gt;%</span>
  <span class='fu'>mutate</span><span class='op'>(</span>trt <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/replace.html'>replace</a></span><span class='op'>(</span><span class='va'>trt</span>, <span class='va'>trt</span> <span class='op'>==</span> <span class='fl'>10</span>, <span class='st'>"CTRL"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span>trt <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/replace.html'>replace</a></span><span class='op'>(</span><span class='va'>trt</span>, <span class='va'>trt</span> <span class='op'>==</span> <span class='fl'>2</span>, <span class='st'>"TEBU"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span>trt <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/replace.html'>replace</a></span><span class='op'>(</span><span class='va'>trt</span>, <span class='va'>trt</span> <span class='op'>==</span> <span class='fl'>3</span>, <span class='st'>"PROP"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span>trt <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/replace.html'>replace</a></span><span class='op'>(</span><span class='va'>trt</span>, <span class='va'>trt</span> <span class='op'>==</span> <span class='fl'>4</span>, <span class='st'>"PROT"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span>trt <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/replace.html'>replace</a></span><span class='op'>(</span><span class='va'>trt</span>, <span class='va'>trt</span> <span class='op'>==</span> <span class='fl'>5</span>, <span class='st'>"TEBU+PROT"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span>trt <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/replace.html'>replace</a></span><span class='op'>(</span><span class='va'>trt</span>, <span class='va'>trt</span> <span class='op'>==</span> <span class='fl'>6</span>, <span class='st'>"MET"</span><span class='op'>)</span><span class='op'>)</span> 
</code></pre>
</div>
</div>
<h3 id="arm-based-model">Arm-based model</h3>
<p>I will use the <a href="http://www.metafor-project.org/doku.php">metafor</a> package, a free and open-source add-on for conducting meta-analyses with the statistical software environment R. I followed the example for fitting the arm-based network MA as shown in <a href="http://www.wvbauer.com/lib/exe/fetch.php/talks:2016_viechtbauer_goettingen_multilevel_multivariate_network_ma.pdf">this presentation</a> by the author of the package.</p>
<p>In the original paper (Madden et al. 2016), the authors compared three different variance-covariance matrix for a random-effects model: compound simetry (CS), heterogeneous CS (HCS) and unstructured (UN). Thse can be informed directly in the <code>rma.mv</code> function.</p>
<p>Let’s load <code>metafor</code> package.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://www.metafor-project.org'>metafor</a></span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h2 id="fixed-effects-model">Fixed effects model</h2>
<p>Here is how to fit Model F1, the fixed-effects model, with a CS (compound symmetry) structure. In metafor, we will use the <code>rma.mv</code> function for fitting mixed effects model for multivariate and multi-treatment situations. We enter the effect of interest, which is <code>yield</code> and the sampling variance <code>varyld</code>. Our moderators will be the additive effect of treatment <code>trt</code> and the trial <code>trial</code> in the fixed effects model. The <code>method</code> is the maximum likelihood. The <code>random</code> component will be treatment and trial, meaning a random intercept and slope for each treatment. The <code>struct</code> is CS and the <code>data</code> is wheat.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>net_arm_CS_fixed</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://wviechtb.github.io/metafor/reference/rma.mv.html'>rma.mv</a></span><span class='op'>(</span><span class='va'>yield</span>, <span class='va'>varyld</span>,
                    mods <span class='op'>=</span> <span class='op'>~</span> <span class='va'>trial</span> <span class='op'>+</span> <span class='va'>trt</span>, 
                    method<span class='op'>=</span> <span class='st'>"ML"</span>,
                    random <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>~</span> <span class='va'>trt</span> <span class='op'>|</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>trial</span><span class='op'>)</span><span class='op'>)</span>,  
                    struct<span class='op'>=</span><span class='st'>"CS"</span>, 
                    data<span class='op'>=</span><span class='va'>wheat</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>net_arm_CS_fixed</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
Multivariate Meta-Analysis Model (k = 558; method: ML)

   logLik   Deviance        AIC        BIC       AICc 
-283.4557  1710.0258   584.9113   623.8306   585.2398   

Variance Components:

outer factor: factor(trial) (nlvls = 136)
inner factor: trt           (nlvls = 6)

            estim    sqrt  fixed 
tau^2      1.5504  1.2452     no 
rho        0.9841             no 

Test for Residual Heterogeneity:
QE(df = 551) = 55024.2244, p-val &lt; .0001

Test of Moderators (coefficients 2:7):
QM(df = 6) = 320.0962, p-val &lt; .0001

Model Results:

              estimate      se     zval    pval    ci.lb   ci.ub 
intrcpt         3.5920  0.2145  16.7477  &lt;.0001   3.1716  4.0123  *** 
trial          -0.0009  0.0027  -0.3150  0.7528  -0.0062  0.0045      
trtMET          0.4361  0.0309  14.1312  &lt;.0001   0.3756  0.4966  *** 
trtPROP         0.1994  0.0361   5.5209  &lt;.0001   0.1286  0.2702  *** 
trtPROT         0.4286  0.0365  11.7564  &lt;.0001   0.3572  0.5001  *** 
trtTEBU         0.2744  0.0258  10.6557  &lt;.0001   0.2239  0.3249  *** 
trtTEBU+PROT    0.4327  0.0306  14.1535  &lt;.0001   0.3728  0.4926  *** 

---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<h2 id="random-effects">Random effects</h2>
<p>For the random effects model, the specification is similar to the fixed, except that trials are considered only random effects in the model.</p>
<h3 id="compound-symmetry">Compound symmetry</h3>
<p>Let’s first fit the model with a compound symmetry (CS) structure for the variance-covariance matrix, which is equivalent to the R1 model in the paper <span class="citation" data-cites="madden2016"><a href="#ref-madden2016" role="doc-biblioref">Madden, Piepho, and Paul</a> (<a href="#ref-madden2016" role="doc-biblioref">2016</a>)</span>. In that case, because all treatments within a study share the same random effect, all treatments are correlated, with a covariance for pairs of treatments given by the between-study variance <span class="citation" data-cites="madden2016"><a href="#ref-madden2016" role="doc-biblioref">Madden, Piepho, and Paul</a> (<a href="#ref-madden2016" role="doc-biblioref">2016</a>)</span></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>net_arm_CS</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://wviechtb.github.io/metafor/reference/rma.mv.html'>rma.mv</a></span><span class='op'>(</span><span class='va'>yield</span>, <span class='va'>varyld</span>,
                    mods <span class='op'>=</span> <span class='op'>~</span> <span class='va'>trt</span>, 
                    method<span class='op'>=</span> <span class='st'>"ML"</span>,
                    random <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>~</span> <span class='va'>trt</span> <span class='op'>|</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>trial</span><span class='op'>)</span><span class='op'>)</span>,  
                    struct<span class='op'>=</span><span class='st'>"CS"</span>,  
                    data<span class='op'>=</span><span class='va'>wheat</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Let’s see the results.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>net_arm_CS</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
Multivariate Meta-Analysis Model (k = 558; method: ML)

   logLik   Deviance        AIC        BIC       AICc 
-283.5052  1710.1250   583.0105   617.6054   583.2728   

Variance Components:

outer factor: factor(trial) (nlvls = 136)
inner factor: trt           (nlvls = 6)

            estim    sqrt  fixed 
tau^2      1.5516  1.2456     no 
rho        0.9841             no 

Test for Residual Heterogeneity:
QE(df = 552) = 55024.7841, p-val &lt; .0001

Test of Moderators (coefficients 2:6):
QM(df = 5) = 319.9986, p-val &lt; .0001

Model Results:

              estimate      se     zval    pval   ci.lb   ci.ub 
intrcpt         3.5335  0.1076  32.8500  &lt;.0001  3.3227  3.7443  *** 
trtMET          0.4360  0.0309  14.1295  &lt;.0001  0.3755  0.4965  *** 
trtPROP         0.1994  0.0361   5.5206  &lt;.0001  0.1286  0.2702  *** 
trtPROT         0.4286  0.0365  11.7560  &lt;.0001  0.3572  0.5001  *** 
trtTEBU         0.2744  0.0258  10.6558  &lt;.0001  0.2239  0.3249  *** 
trtTEBU+PROT    0.4326  0.0306  14.1523  &lt;.0001  0.3727  0.4925  *** 

---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<h3 id="heterogeneous-cs">Heterogeneous CS</h3>
<p>Alternatively, between-study variance can be considered unequal when there is an overall random study effect. In this model there is a constant between-study correlation for all pairs of treatments with unequal between-study total variances, and this matrix is called heterogeneous compound symmetry (HCS). This the R2 model in <span class="citation" data-cites="madden2016"><a href="#ref-madden2016" role="doc-biblioref">Madden, Piepho, and Paul</a> (<a href="#ref-madden2016" role="doc-biblioref">2016</a>)</span>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Be patient. The model fit may take more than a minute running</span>
<span class='va'>net_arm_HCS</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://wviechtb.github.io/metafor/reference/rma.mv.html'>rma.mv</a></span><span class='op'>(</span><span class='va'>yield</span>, <span class='va'>varyld</span>,
                    mods <span class='op'>=</span> <span class='op'>~</span>  <span class='va'>trt</span>, 
                    method<span class='op'>=</span> <span class='st'>"ML"</span>,
                    random <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>~</span> <span class='va'>trt</span> <span class='op'>|</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>trial</span><span class='op'>)</span><span class='op'>)</span>,  
                    struct<span class='op'>=</span><span class='st'>"HCS"</span>,  data<span class='op'>=</span><span class='va'>wheat</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>And the results.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>net_arm_HCS</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
Multivariate Meta-Analysis Model (k = 558; method: ML)

   logLik   Deviance        AIC        BIC       AICc 
-278.3457  1699.8060   582.6915   638.9082   583.3606   

Variance Components:

outer factor: factor(trial) (nlvls = 136)
inner factor: trt           (nlvls = 6)

            estim    sqrt  k.lvl  fixed      level 
tau^2.1    1.6636  1.2898    136     no       CTRL 
tau^2.2    1.4271  1.1946     86     no        MET 
tau^2.3    1.5232  1.2342     57     no       PROP 
tau^2.4    1.5315  1.2375     56     no       PROT 
tau^2.5    1.5312  1.2374    136     no       TEBU 
tau^2.6    1.5056  1.2270     87     no  TEBU+PROT 
rho        0.9848                    no            

Test for Residual Heterogeneity:
QE(df = 552) = 55024.7841, p-val &lt; .0001

Test of Moderators (coefficients 2:6):
QM(df = 5) = 301.4403, p-val &lt; .0001

Model Results:

              estimate      se     zval    pval   ci.lb   ci.ub 
intrcpt         3.5379  0.1113  31.7790  &lt;.0001  3.3197  3.7561  *** 
trtMET          0.4334  0.0312  13.8703  &lt;.0001  0.3722  0.4947  *** 
trtPROP         0.1946  0.0360   5.4039  &lt;.0001  0.1240  0.2651  *** 
trtPROT         0.4263  0.0364  11.7284  &lt;.0001  0.3551  0.4976  *** 
trtTEBU         0.2687  0.0260  10.3307  &lt;.0001  0.2177  0.3196  *** 
trtTEBU+PROT    0.4290  0.0307  13.9841  &lt;.0001  0.3688  0.4891  *** 

---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<h3 id="unstructured-matrix">Unstructured matrix</h3>
<p>Finally, we fit the model with an unstructure (UN) variance-covariance matrix. Here, we allow the matrix to be completely unstructured, with different variance for each treatment or different covariance (correlation) for each pair of treatments. Note: I needed to use an optimizer for allowing convergence.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Be more patient. This may take much longer to complete run.</span>
<span class='va'>net_arm_UN</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://wviechtb.github.io/metafor/reference/rma.mv.html'>rma.mv</a></span><span class='op'>(</span><span class='va'>yield</span>, <span class='va'>varyld</span>,
                    mods <span class='op'>=</span> <span class='op'>~</span> <span class='va'>trt</span>, 
                    method<span class='op'>=</span> <span class='st'>"ML"</span>,
                    random <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>~</span> <span class='va'>trt</span> <span class='op'>|</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>trial</span><span class='op'>)</span><span class='op'>)</span>, 
                    struct<span class='op'>=</span><span class='st'>"UN"</span>, 
                    control<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>optimizer <span class='op'>=</span> <span class='st'>"nlm"</span><span class='op'>)</span>, 
                    data<span class='op'>=</span><span class='va'>wheat</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Let’s see the results:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>net_arm_UN</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
Multivariate Meta-Analysis Model (k = 558; method: ML)

   logLik   Deviance        AIC        BIC       AICc 
-242.0879  1627.2903   538.1758   654.9335   541.0286   

Variance Components:

outer factor: factor(trial) (nlvls = 136)
inner factor: trt           (nlvls = 6)

            estim    sqrt  k.lvl  fixed      level 
tau^2.1    1.6620  1.2892    136     no       CTRL 
tau^2.2    1.4346  1.1977     86     no        MET 
tau^2.3    1.5284  1.2363     57     no       PROP 
tau^2.4    1.5182  1.2321     56     no       PROT 
tau^2.5    1.5224  1.2339    136     no       TEBU 
tau^2.6    1.5221  1.2338     87     no  TEBU+PROT 

           rho.CTRL  rho.MET  rho.PROP  rho.PROT  rho.TEBU  rho.TEBU+ 
CTRL              1   0.9764    0.9890    0.9730    0.9862     0.9616 
MET          0.9764        1    0.9896    0.9995    0.9887     0.9948 
PROP         0.9890   0.9896         1    0.9860    0.9909     0.9786 
PROT         0.9730   0.9995    0.9860         1    0.9874     0.9966 
TEBU         0.9862   0.9887    0.9909    0.9874         1     0.9880 
TEBU+PROT    0.9616   0.9948    0.9786    0.9966    0.9880          1 
             CTRL  MET  PROP  PROT  TEBU  TEBU+ 
CTRL            -   no    no    no    no     no 
MET            86    -    no    no    no     no 
PROP           57   42     -    no    no     no 
PROT           56   41    24     -    no     no 
TEBU          136   86    57    56     -     no 
TEBU+PROT      87   74    39    47    87      - 

Test for Residual Heterogeneity:
QE(df = 552) = 55024.7841, p-val &lt; .0001

Test of Moderators (coefficients 2:6):
QM(df = 5) = 200.3051, p-val &lt; .0001

Model Results:

              estimate      se     zval    pval   ci.lb   ci.ub 
intrcpt         3.5353  0.1113  31.7666  &lt;.0001  3.3171  3.7534  *** 
trtMET          0.4502  0.0332  13.5554  &lt;.0001  0.3851  0.5153  *** 
trtPROP         0.1991  0.0322   6.1804  &lt;.0001  0.1360  0.2623  *** 
trtPROT         0.4192  0.0373  11.2287  &lt;.0001  0.3461  0.4924  *** 
trtTEBU         0.2725  0.0251  10.8399  &lt;.0001  0.2232  0.3218  *** 
trtTEBU+PROT    0.4445  0.0385  11.5454  &lt;.0001  0.3690  0.5199  *** 

---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<h3 id="model-comparison">Model comparison</h3>
<p>Let’s extract the mean estimate and the respective standard error from each of the models namely R1 (CS), R2(HCS) and R3(UN) as in the original paper.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://github.com/tidyverse/broom'>broom</a></span><span class='op'>)</span>

<span class='va'>R1_mean</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://generics.r-lib.org/reference/tidy.html'>tidy</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>net_arm_CS</span><span class='op'>$</span><span class='va'>b</span>, <span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>R2_mean</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://generics.r-lib.org/reference/tidy.html'>tidy</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>net_arm_HCS</span><span class='op'>$</span><span class='va'>b</span>,<span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>R3_mean</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://generics.r-lib.org/reference/tidy.html'>tidy</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>net_arm_UN</span><span class='op'>$</span><span class='va'>b</span>,<span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>R1_se</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://generics.r-lib.org/reference/tidy.html'>tidy</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>net_arm_CS</span><span class='op'>$</span><span class='va'>se</span>,<span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>R2_se</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://generics.r-lib.org/reference/tidy.html'>tidy</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>net_arm_HCS</span><span class='op'>$</span><span class='va'>se</span>,<span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>R3_se</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://generics.r-lib.org/reference/tidy.html'>tidy</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>net_arm_UN</span><span class='op'>$</span><span class='va'>se</span>,<span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>And now we prepare a table for displaying the statistics.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>table1</span> <span class='op'>&lt;-</span> 
  <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span><span class='va'>R1_mean</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>, <span class='va'>R1_mean</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span>,<span class='va'>R1_se</span>, <span class='va'>R2_mean</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span>, <span class='va'>R2_se</span>, <span class='va'>R3_mean</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span>, <span class='va'>R3_se</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>table1</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Treat"</span>, <span class='st'>"R1_mean"</span>, <span class='st'>"R1_se"</span>, <span class='st'>"R2_mean"</span>, <span class='st'>"R2_se"</span>, <span class='st'>"R3_mean"</span>, <span class='st'>"R3_se"</span><span class='op'>)</span>
<span class='va'>table1</span><span class='op'>$</span><span class='va'>Treat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"CTRL"</span>, <span class='st'>"MET"</span>, <span class='st'>"PROP"</span>, <span class='st'>"PROT"</span>, <span class='st'>"TEBU"</span>, <span class='st'>"TEBU+PROT"</span><span class='op'>)</span>
<span class='va'>table1</span>
</code></pre>
</div>
<pre><code>      Treat R1_mean R1_se R2_mean R2_se R3_mean R3_se
1      CTRL   3.534 0.108   3.538 0.111   3.535 0.111
2       MET   0.436 0.031   0.433 0.031   0.450 0.033
3      PROP   0.199 0.036   0.195 0.036   0.199 0.032
4      PROT   0.429 0.036   0.426 0.036   0.419 0.037
5      TEBU   0.274 0.026   0.269 0.026   0.272 0.025
6 TEBU+PROT   0.433 0.031   0.429 0.031   0.444 0.038</code></pre>
</div>
<p>As in the original paper, we will compare all three models based on the LRT test. The full model uses the UN variance-covariance matrix. As in the paper, the UN provided a better fit to the data and had the lowest AIC.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/stats/anova.html'>anova</a></span><span class='op'>(</span><span class='va'>net_arm_HCS</span>, <span class='va'>net_arm_CS</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
        df      AIC      BIC     AICc    logLik     LRT   pval 
Full    13 582.6915 638.9082 583.3606 -278.3457                
Reduced  8 583.0105 617.6054 583.2728 -283.5052 10.3190 0.0667 
                QE 
Full    55024.7841 
Reduced 55024.7841 </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/stats/anova.html'>anova</a></span><span class='op'>(</span><span class='va'>net_arm_CS</span>, <span class='va'>net_arm_UN</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
        df      AIC      BIC     AICc    logLik     LRT   pval 
Full    27 538.1758 654.9335 541.0286 -242.0879                
Reduced  8 583.0105 617.6054 583.2728 -283.5052 82.8347 &lt;.0001 
                QE 
Full    55024.7841 
Reduced 55024.7841 </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/stats/anova.html'>anova</a></span><span class='op'>(</span><span class='va'>net_arm_HCS</span>, <span class='va'>net_arm_UN</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
        df      AIC      BIC     AICc    logLik     LRT   pval 
Full    27 538.1758 654.9335 541.0286 -242.0879                
Reduced 13 582.6915 638.9082 583.3606 -278.3457 72.5157 &lt;.0001 
                QE 
Full    55024.7841 
Reduced 55024.7841 </code></pre>
</div>
<p>Using the best model, we can apply a multi-comparison test for a head-to-head comparison based on the network model results. We can do it using <code>multcomp</code> package.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://multcomp.R-forge.R-project.org'>multcomp</a></span><span class='op'>)</span>
<span class='va'>net_arm_UN_comp</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/multcomp/man/glht.html'>glht</a></span><span class='op'>(</span><span class='va'>net_arm_UN</span>, linfct<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/multcomp/man/contrMat.html'>contrMat</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>6</span><span class='op'>)</span>, type<span class='op'>=</span><span class='st'>"Tukey"</span><span class='op'>)</span><span class='op'>)</span>, test<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/pkg/multcomp/man/methods.html'>adjusted</a></span><span class='op'>(</span><span class='st'>"none"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>net_arm_UN_comp</span>
</code></pre>
</div>
<pre><code>
     Simultaneous Tests for General Linear Hypotheses

Fit: rma.mv(yi = yield, V = varyld, mods = ~trt, random = list(~trt | 
    factor(trial)), struct = &quot;UN&quot;, data = wheat, method = &quot;ML&quot;, 
    control = list(optimizer = &quot;nlm&quot;))

Linear Hypotheses:
            Estimate Std. Error z value Pr(&gt;|z|)    
2 - 1 == 0 -3.085058   0.126778 -24.334   &lt;0.001 ***
3 - 1 == 0 -3.336116   0.122440 -27.247   &lt;0.001 ***
4 - 1 == 0 -3.116038   0.125742 -24.781   &lt;0.001 ***
5 - 1 == 0 -3.262772   0.121188 -26.923   &lt;0.001 ***
6 - 1 == 0 -3.090792   0.127090 -24.320   &lt;0.001 ***
3 - 2 == 0 -0.251058   0.034194  -7.342   &lt;0.001 ***
4 - 2 == 0 -0.030980   0.027119  -1.142    0.840    
5 - 2 == 0 -0.177714   0.027605  -6.438   &lt;0.001 ***
6 - 2 == 0 -0.005734   0.024757  -0.232    1.000    
4 - 3 == 0  0.220078   0.038807   5.671   &lt;0.001 ***
5 - 3 == 0  0.073344   0.030924   2.372    0.141    
6 - 3 == 0  0.245325   0.038301   6.405   &lt;0.001 ***
5 - 4 == 0 -0.146734   0.031853  -4.607   &lt;0.001 ***
6 - 4 == 0  0.025247   0.027883   0.905    0.934    
6 - 5 == 0  0.171981   0.028104   6.119   &lt;0.001 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
(Adjusted p values reported -- single-step method)</code></pre>
</div>
<p>And we can make a plot for it.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span><span class='op'>(</span><span class='va'>net_arm_UN_comp</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="network-meta-analysis-in-r_files/figure-html5/unnamed-chunk-17-1.png" width="624" /></p>
</div>
<h3 id="moderator-effects">Moderator effects</h3>
<p>In the original paper, two models were expanded to include the effect of wheat class(S = Spring wheat and W = Winter wheat) as moderator. Let’s fit the CS model as in the paper with the moderator.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>net_arm_CS_class</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://wviechtb.github.io/metafor/reference/rma.mv.html'>rma.mv</a></span><span class='op'>(</span><span class='va'>yield</span>, <span class='va'>varyld</span>,
                    mods <span class='op'>=</span> <span class='op'>~</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>trt</span><span class='op'>)</span><span class='op'>*</span><span class='va'>class</span>, 
                    method<span class='op'>=</span> <span class='st'>"ML"</span>,
                    random <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>~</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>trt</span><span class='op'>)</span> <span class='op'>|</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>trial</span><span class='op'>)</span><span class='op'>)</span>,  
                    struct<span class='op'>=</span><span class='st'>"HCS"</span>,  data<span class='op'>=</span><span class='va'>wheat</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>As usual, we look at the model summary. Now we can see estimates for each combination of treatment and wheat class.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>net_arm_CS_class</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
Multivariate Meta-Analysis Model (k = 558; method: ML)

   logLik   Deviance        AIC        BIC       AICc 
-268.1385  1679.3915   574.2770   656.4398   575.6897   

Variance Components:

outer factor: factor(trial) (nlvls = 136)
inner factor: factor(trt)   (nlvls = 6)

            estim    sqrt  k.lvl  fixed      level 
tau^2.1    1.4653  1.2105    136     no       CTRL 
tau^2.2    1.2939  1.1375     86     no        MET 
tau^2.3    1.3777  1.1738     57     no       PROP 
tau^2.4    1.3796  1.1746     56     no       PROT 
tau^2.5    1.3820  1.1756    136     no       TEBU 
tau^2.6    1.3500  1.1619     87     no  TEBU+PROT 
rho        0.9834                    no            

Test for Residual Heterogeneity:
QE(df = 546) = 45668.0682, p-val &lt; .0001

Test of Moderators (coefficients 2:12):
QM(df = 11) = 337.5308, p-val &lt; .0001

Model Results:

                             estimate      se     zval    pval 
intrcpt                        3.0217  0.1598  18.9068  &lt;.0001 
factor(trt)MET                 0.5226  0.0431  12.1350  &lt;.0001 
factor(trt)PROP                0.2647  0.0499   5.3060  &lt;.0001 
factor(trt)PROT                0.4986  0.0573   8.7051  &lt;.0001 
factor(trt)TEBU                0.3353  0.0368   9.1056  &lt;.0001 
factor(trt)TEBU+PROT           0.4886  0.0438  11.1556  &lt;.0001 
classW                         0.9057  0.2114   4.2849  &lt;.0001 
factor(trt)MET:classW         -0.1686  0.0614  -2.7444  0.0061 
factor(trt)PROP:classW        -0.1331  0.0714  -1.8648  0.0622 
factor(trt)PROT:classW        -0.1286  0.0738  -1.7437  0.0812 
factor(trt)TEBU:classW        -0.1230  0.0512  -2.4017  0.0163 
factor(trt)TEBU+PROT:classW   -0.1092  0.0606  -1.8020  0.0715 
                               ci.lb    ci.ub 
intrcpt                       2.7085   3.3350  *** 
factor(trt)MET                0.4382   0.6070  *** 
factor(trt)PROP               0.1669   0.3624  *** 
factor(trt)PROT               0.3864   0.6109  *** 
factor(trt)TEBU               0.2631   0.4075  *** 
factor(trt)TEBU+PROT          0.4028   0.5745  *** 
classW                        0.4914   1.3200  *** 
factor(trt)MET:classW        -0.2890  -0.0482   ** 
factor(trt)PROP:classW       -0.2729   0.0068    . 
factor(trt)PROT:classW       -0.2732   0.0160    . 
factor(trt)TEBU:classW       -0.2234  -0.0226    * 
factor(trt)TEBU+PROT:classW  -0.2280   0.0096    . 

---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<p>We can check whether the full model with the moderator is a better fit than the reduced (without moderator) model. The P-value of the LRT test suggests that indeed wheat class has a strong effect on treatment effects. This agrees with the results using SAS.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/stats/anova.html'>anova</a></span><span class='op'>(</span><span class='va'>net_arm_CS</span>, <span class='va'>net_arm_CS_class</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
        df      AIC      BIC     AICc    logLik     LRT   pval 
Full    19 574.2770 656.4398 575.6897 -268.1385                
Reduced  8 583.0105 617.6054 583.2728 -283.5052 30.7335 0.0012 
                QE 
Full    45668.0682 
Reduced 55024.7841 </code></pre>
</div>
<p>So recapping, we fitted five models: fixed effects, three random effects with different structures and the one with a moderator variables. Results are not identical to those obtained in <span class="citation" data-cites="madden2016"><a href="#ref-madden2016" role="doc-biblioref">Madden, Piepho, and Paul</a> (<a href="#ref-madden2016" role="doc-biblioref">2016</a>)</span>, but they are all very similar.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-madden2016" class="csl-entry" role="doc-biblioentry">
Madden, L. V., H.-P. Piepho, and P. A. Paul. 2016. <span>“Statistical Models and Methods for Network Meta-Analysis.”</span> <em>Phytopathology®</em> 106 (8): 792–806. <a href="https://doi.org/10.1094/phyto-12-15-0342-rvw">https://doi.org/10.1094/phyto-12-15-0342-rvw</a>.
</div>
</div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>


<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
<h3 id="references">References</h3>
<div id="references-listing"></div>
</div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
